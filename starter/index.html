
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../implementation/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.7">
    
    
      
        <title>Getting started - Lab 2, Authorization & Trust</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4b4a2bd9.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#getting-started" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Lab 2, Authorization &amp; Trust" class="md-header__button md-logo" aria-label="Lab 2, Authorization & Trust" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 19h1a1 1 0 0 1 1 1h7v2h-7a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1H2v-2h7a1 1 0 0 1 1-1h1v-1.66C8.07 16.13 6 13 6 9.67v-4L12 3l6 2.67v4c0 3.33-2.07 6.46-5 7.67V19M12 5 8 6.69V10h4V5m0 5v6c1.91-.47 4-2.94 4-5v-1h-4Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Lab 2, Authorization & Trust
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Getting started
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/15316-cmu/lab2-2023" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Lab 2, Authorization &amp; Trust" class="md-nav__button md-logo" aria-label="Lab 2, Authorization & Trust" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 19h1a1 1 0 0 1 1 1h7v2h-7a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1H2v-2h7a1 1 0 0 1 1-1h1v-1.66C8.07 16.13 6 13 6 9.67v-4L12 3l6 2.67v4c0 3.33-2.07 6.46-5 7.67V19M12 5 8 6.69V10h4V5m0 5v6c1.91-.47 4-2.94 4-5v-1h-4Z"/></svg>

    </a>
    Lab 2, Authorization & Trust
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/15316-cmu/lab2-2023" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#credentials" class="md-nav__link">
    Credentials
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#certificates" class="md-nav__link">
    Certificates
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#private-keys" class="md-nav__link">
    Private keys
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authorization-logic" class="md-nav__link">
    Authorization Logic
  </a>
  
    <nav class="md-nav" aria-label="Authorization Logic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sequents-and-judgements" class="md-nav__link">
    Sequents and judgements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proof-rules" class="md-nav__link">
    Proof rules
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    Next steps
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../implementation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorization goals
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorization mechanics
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../tactics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The prover
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing your prover
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../exploit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exploiting a vulnerability
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../utility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utility code
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#credentials" class="md-nav__link">
    Credentials
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#certificates" class="md-nav__link">
    Certificates
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#private-keys" class="md-nav__link">
    Private keys
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authorization-logic" class="md-nav__link">
    Authorization Logic
  </a>
  
    <nav class="md-nav" aria-label="Authorization Logic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sequents-and-judgements" class="md-nav__link">
    Sequents and judgements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proof-rules" class="md-nav__link">
    Proof rules
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    Next steps
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="getting-started">Getting started</h1>
<p>Clone this repository onto your local machine or your Andrew home directory.</p>
<p>You will need to use Python 3.10 to complete this lab. You can reuse the virtual environment that you created for Lab 1. The only new dependency that you will need to complete the lab is the <code>cryptography</code> modulo, which you can install either via <code>pip</code> or <code>conda</code> from within your environment.</p>
<pre><code>&gt; [pip|conda] install cryptography
</code></pre>
<p>You should then copy your private key, along with the credentials that you will need into the repository directory. Assuming <code>&lt;id&gt;</code> is your Andrew ID, run the following command:</p>
<pre><code>scp -r &lt;id&gt;@linux.andrew.cmu.edu:/afs/andrew.cmu.edu/usr8/mfredrik/15316-f23/&lt;id&gt;/* .
</code></pre>
<h2 id="credentials">Credentials</h2>
<p>You should now have a <code>credentials</code> directory with the following contents:</p>
<pre><code>&lt;id&gt;_secret.cred
&lt;id&gt;_shared.cred
&lt;id&gt;_txt.cred
dsduena_secret.cred
justinyo_secret.cred
mdhamank_secret.cred
mfredrik_secret.cred
mfredrik_shared.cred
policy1.cred
policy2.cred
siruih_secret.cred
</code></pre>
<p>A <em>credential</em> is a formula expresses the policy intent of an agent, that is signed by their private key to provide authenticity. For example, <code>policy1.cred</code> contains the following:</p>
<pre><code>{
  &quot;p&quot;: &quot;(@A . (((#mfredrik says open(A, &lt;shared.txt&gt;)) -&gt; open(A, &lt;shared.txt&gt;))))&quot;,
  &quot;signator&quot;: &quot;#root&quot;,
  &quot;signature&quot;: &quot;c397b1d047279a4f544ae7eecafed3939b2780bc4f61b443849ec62069ce2b8353c5805cb102753f9b309d12541cc25349cced3cb830a137e30610f677068d02&quot;
}
</code></pre>
<p>Here, <code>p</code> contains the policy formula, <code>signator</code> refers to the agent who signed the formula, and the bytes of the actual digital signature are given in <code>signature</code>.
We are more familiar working with credentials as <code>sign</code> formulas, and we can get such a formula from the credential, and pretty-print it using <code>util.stringify</code>:</p>
<pre><code>&gt; import crypto, util
&gt; cred = crypto.Credential.load_credential('credentials/policy1.cred')
&gt; print(stringify(cred.sign_formula()))
sign(((@A . (((#mfredrik says open(A, &lt;shared.txt&gt;)) -&gt; open(A, &lt;shared.txt&gt;))))), [2b:8f:e8:9b])
</code></pre>
<p>The second argument appearing in square brackets is a digest of the signer's public key.</p>
<p>Each policy used in this lab has a corresponding credential; the details of those policies are described in the implementation section of this documentation.
You do not need to worry about manually loading credentials in most cases, as <code>auth.load_all_credentials</code> will do it for you.</p>
<h2 id="certificates">Certificates</h2>
<p>You should now have a <code>certs</code> directory with the following files (assuming <code>&lt;id&gt;</code> is your Andrew ID).</p>
<pre><code>&lt;id&gt;.cert
ca.cert
dsduena.cert
justinyo.cert
mdhamank.cert
mfredrik.cert
root.cert
siruih.cert
</code></pre>
<p>A <em>certificate</em> is a formula in which a certificate authority (identified by <code>#ca</code> in this lab) signs that a public key belongs to a given agent:</p>
<pre><code>sign(iskey(#agent, [agent_key_fingerprint]), [ca_key_fingerprint])
</code></pre>
<p>A key fingerprint is a string that uniquely identifies a public key, for example <code>[68:d7:6c:b7:95:fb:a4:f7:a7:4f:12:44:6f:27:c5:40]</code>.</p>
<details>
<summary>What's in a certificate?</summary>

Looking at `certs/root.cert`, the contents are as follows.

<pre><code>{
  &quot;agent&quot;: &quot;#root&quot;,
  &quot;cred&quot;: {
    &quot;p&quot;: &quot;iskey(#root, [2b:8f:e8:9b:8b:76:37:a7:3b:7e:85:49:9d:87:7b:3b])&quot;,
    &quot;signator&quot;: &quot;#ca&quot;,
    &quot;signature&quot;: &quot;4c120014db10eade1ab7a14f6745c94067f13bb38e4424c8084c24688a062268db37a08f480f571c90700afae07070c96428965cd19d20d3d2f105231ee60706&quot;
  },
  &quot;public_key&quot;: &quot;2d2d2d2d2d424547494e205055424c4943204b45592d2d2d2d2d0a4d436f77425159444b32567741794541506844563357384a466d45547767366d69396b416262484e2b5742506c4e586f743372486f36466e5430303d0a2d2d2d2d2d454e44205055424c4943204b45592d2d2d2d2d0a&quot;
}
</code></pre>

Notice that the actual formula is given in `cert.cred.p`, in addition to easily-accessible metadata such as which party's public key is being certified (`cert.agent = #root`) and who the CA is (`cert.cred.signator = ca`).

<p>

Additionally, certificate files contain the base64-encoded digital signature (`cert.cred.signature`), signed using the public key of `cert.cred.signator`, as well as the public key of `cert.agent` (in this case, `#root`) in `cert.public_key`. If `#root` were to sign a credential, then it could be verified using this public key.
</details>

<h2 id="private-keys">Private keys</h2>
<p>Finally, in the <code>private_keys</code> directory, you should see:</p>
<pre><code>&lt;id&gt;.pem
</code></pre>
<p>You do not need to worry about the specific details of private keys, and you will not need to work directly with them: the code handed out with this lab takes care of creating signatures and certificates from private keys that you have access to.
The APIs for doing this are discussed in more detail in <a href="../exploit/">exploiting a vulnerability</a>.</p>
<h2 id="authorization-logic">Authorization Logic</h2>
<p><code>logic.py</code> defines the authorization logic that we have discussed in class. 
There are three types of constants: agents, keys, and resources. </p>
<ul>
<li><code>Agent</code> constants are prefixed with <code>#</code>.</li>
<li><code>Key</code> constants appear between brackets <code>[]</code>.</li>
<li><code>Resource</code> constants appear between angle brackets <code>&lt;&gt;</code>.</li>
</ul>
<p>In formulas, locations expecting a constant of a particular type can also recieve a variable, which is just an alphanumeric string that is not prefixed with any special characters. 
Both of the following are syntactically valid formulas, where the first has three variables that are replaced by corresponding constants in the second.</p>
<pre><code>A says open(B, R)
#A says open(#B, &lt;R&gt;)
</code></pre>
<p>A parser is provided in <code>parser.py</code>, and we strongly recommend that you use the parser to construct formula objects, rather than building them manually from the constructors in <code>logic.py</code>.</p>
<pre><code>&gt; parse('A says P')
App(op=&lt;Operator.SAYS: 7&gt;, arity=2, args=[Variable(id='A'), Variable(id='P')])
</code></pre>
<p>The logic supports universal quantifiers, and uses the <code>@</code> symbol for them.
When parsing quantified formulas, note that you should surround the quantified formula with parentheses to avoid potential parser errors. 
So the following may result in a parser error. </p>
<pre><code>parse('@x . @y . open(x, y)')
</code></pre>
<p>It should be run as follows.</p>
<pre><code>parse('@x . (@y . (open(x, y)))')
</code></pre>
<h3 id="sequents-and-judgements">Sequents and judgements</h3>
<p>When building sequents, our authorization logic distinguishes between affirmation justdments and truth judgements.
Truth judgements are denoted by writing <code>true</code> after a formula, and are represented by the <code>Proposition</code> class in <code>logic.py</code>.</p>
<pre><code>&gt; parse('(P -&gt; Q) true')
Proposition(p=App(op=&lt;Operator.IMPLIES: 4&gt;, arity=2, args=[Variable(id='P'), Variable(id='Q')]))
</code></pre>
<p>Affirmation judgements are denoted by juxtaposing a principal, <code>aff</code>, and a formula.</p>
<pre><code>&gt; parse('A aff P -&gt; Q')
Affirmation(a=Variable(id='A'), p=App(op=&lt;Operator.IMPLIES: 4&gt;, arity=2, args=[Variable(id='P'), Variable(id='Q')]))
</code></pre>
<p>Sequents are expressed using <code>|-</code>, and accept either type of judgement on the right.</p>
<pre><code>&gt; parse('P |- A aff P')
Sequent(gamma=[Proposition(p=Variable(id='P'))], delta=Affirmation(a=Variable(id='A'), p=Variable(id='P')))
</code></pre>
<p>Note that if you do not write <code>true</code> to expressly denote a truth judgement, the parser will assume that this was what you intended to do.</p>
<pre><code>&gt; parse('P |- Q')
Sequent(gamma=[Proposition(p=Variable(id='P'))], delta=Proposition(p=Variable(id='Q')))
</code></pre>
<h3 id="proof-rules">Proof rules</h3>
<p>The proof rules available in this logic are listed in <code>proofrules.py</code>.</p>
<pre><code>@dataclass(eq=True, frozen=True)
class Rule:
    premises: list[Sequent]
    conclusion: Sequent
    name: str
</code></pre>
<p>As one might expect, a rule is comprised of a list of premises, each its own sequent, and a conclusion sequent. The convention that we use for specifying premises and the conclusion is illustrated by the left implication rule.</p>
<pre><code>Rule(
    [
        parse('|- P true'),
        parse('Q true |- R true')
    ],
    parse('P -&gt; Q true |- R true'),
    '-&gt;L'
)
</code></pre>
<p>Proof rules and sequents are composed to build <code>Proof</code> objects.</p>
<pre><code>@dataclass(eq=True, frozen=True)
class Proof:
    premises: list[Proof | Sequent]
    conclusion: Sequent
    rule: Rule
</code></pre>
<p>Each step of a proof much refer to a <code>Rule</code> defined in <code>proofrules.py</code>; you should not invent your own rules to use in proofs. Proofs are generated by <em>tactics</em> in this lab (more on this later), but for the purposes of illustration, we can manually write the following proof to reflect and application of the left implication rule.</p>
<pre><code>Proof(
    [
        parse('(c -&gt; d) -&gt; e |- a'),
        parse('b, (c -&gt; d) -&gt; e |- f')
    ],
    parse('a -&gt; b, (c -&gt; d) -&gt; e |- f'),
    impLeftRule
)
</code></pre>
<p>The <code>stringify</code> helper from <code>util.py</code> will print this out nicely.</p>
<pre><code>   ((c -&gt; d) -&gt; e) true |- a true  b true, ((c -&gt; d) -&gt; e) true |- f true
-&gt;L ------------------------------------------------------------------------
                (a -&gt; b) true, ((c -&gt; d) -&gt; e) true |- f true
</code></pre>
<p>Note that your proofs may become wider than your screen.
You can specify the width that <code>stringify</code> should be limited to with the <code>pf_width</code> keyword argument, and it will split premises apart from the main proof and print them separately.</p>
<pre><code>&gt; print(stringify(pf, pf_width=50))
                          T.0  T.1
-&gt;L --------------------------------------------------
      (a -&gt; b) true, ((c -&gt; d) -&gt; e) true |- f true

Proof T.1:
b true, ((c -&gt; d) -&gt; e) true |- f true

Proof T.0:
((c -&gt; d) -&gt; e) true |- a true
</code></pre>
<p>Looking at the rules available in <code>proofrules.py</code>, most should be familiar from lecture. The exceptions are <code>impLeftAffRule</code>, <code>forallLeftAffRule</code>, and <code>affCutRule</code>.</p>
<pre><code>impLeftAffRule = Rule(
    [
        parse('|- P true'),
        parse('Q true |- A aff R')
    ],
    parse('P -&gt; Q true |- A aff R'),
    '-&gt;L'
)

forallLeftAffRule = Rule(
    [parse('P(e) |- A aff Q')],
    parse('@x . P(x) |- A aff Q'),
    '@L'
)

affCutRule = Rule(
    [
        parse('|- P true'),
        parse('P true |- A aff Q')
    ],
    parse('|- A aff Q'),
    'affcut'
)
</code></pre>
<p>These rules are the same as their "normal" counterparts from lecture, but they match sequents with an affirmation judgement on the right. You are free to use these rules when constructing <code>Proof</code> objects, and doing so should make developing tactics less intricate, as you have more freedom to decide when to apply the right <code>says</code> rule.</p>
<details>

<summary>Full grammar of the logic</summary>


<pre><code>&lt;agent&gt;   ::= x                            // variable
            | #a                           // constant

&lt;key&gt;     ::= x                            // variable
            | [k]                          // constant

&lt;resource&gt; ::= x                           // variable
            | &lt;r&gt;                          // constant

&lt;formula&gt; ::= x                            // variable
            | &lt;formula&gt; -&gt; &lt;formula&gt;       // implication
            | &lt;agent&gt; says &lt;formula&gt;
            | iskey(&lt;agent&gt;, &lt;key&gt;)
            | sign(&lt;formula&gt;, &lt;key&gt;)
            | ca(&lt;agent&gt;)
            | open(&lt;agent&gt;, &lt;resource&gt;)
            | @x . &lt;formula&gt;               // universal quantifier

&lt;judgement&gt; ::= &lt;formula&gt; true             // proposition
              | &lt;agent&gt; aff &lt;formula&gt;      // affirmation

&lt;sequent&gt; ::= &lt;judgement&gt;* |- &lt;judgement&gt;
</code></pre>

</details>

<h2 id="next-steps">Next steps</h2>
<p>Now that you're familiar with the building blocks needed to write authorization proofs, check out the <a href="../implementation/">authorization goals</a> for the lab.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.aecac24b.min.js"></script>
      
    
  </body>
</html>